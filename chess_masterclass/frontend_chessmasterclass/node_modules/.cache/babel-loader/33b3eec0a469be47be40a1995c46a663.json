{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/tomas/Desktop/chess-masterclass/backend/chess_masterclass/frontend_chessmasterclass/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/tomas/Desktop/chess-masterclass/backend/chess_masterclass/frontend_chessmasterclass/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/tomas/Desktop/chess-masterclass/backend/chess_masterclass/frontend_chessmasterclass/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect,useContext}from'react';import{UserContext}from'../context/UserContext';import{checkCurrentPremiumPlan}from'../utils/utlis';import{BsFillHeartFill}from'react-icons/bs';import{useParams,Link,useNavigate}from'react-router-dom';import ChessDiv from'../components/ChessDiv';import LikeHeart from'../components/LikeHeart';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var CoursePage=function CoursePage(){var _useContext=useContext(UserContext),userInfo=_useContext.userInfo;var navigate=useNavigate();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isCourseLiked=_useState2[0],setIsColorLiked=_useState2[1];// get dynamic ID (from App.js course/:id)\nvar courseSlug=useParams().slug;// list of course detail\nvar _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),courseDetails=_useState4[0],setCourseDetails=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),chessTables=_useState6[0],setChessTables=_useState6[1];// fetch course details\nvar courseDetailGET=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"http://127.0.0.1:8000/api/courses/\".concat(courseSlug));case 2:response=_context.sent;_context.next=5;return response.json();case 5:data=_context.sent;setCourseDetails(data);console.log(data);if(!checkCurrentPremiumPlan(data,userInfo)){navigateToHomePage();}if(data.liked_by.indexOf(userInfo.user_id)===-1){setIsColorLiked(false);}else{setIsColorLiked(true);}case 10:case\"end\":return _context.stop();}}},_callee);}));return function courseDetailGET(){return _ref.apply(this,arguments);};}();// function which call for api port with chess tables\nvar tablesGET=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var response,data;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return fetch(\"http://127.0.0.1:8000/api/courses/\".concat(courseSlug,\"/table\"));case 2:response=_context2.sent;_context2.next=5;return response.json();case 5:data=_context2.sent;setChessTables(data);console.log(data);case 8:case\"end\":return _context2.stop();}}},_callee2);}));return function tablesGET(){return _ref2.apply(this,arguments);};}();// let checkIfLiked = () => {        \n//     // if(courseDetails.liked_courses.indexOf(1) === -1){            \n//     if(courseDetails.liked_by.indexOf(1) === -1){        \n//         console.log(courseDetails.liked_by)\n//         console.log(typeof(courseDetails.liked_by[0]))\n//         console.log(typeof(1))\n//         console.log(userInfo.user_id)\n//         return false\n//     }else{\n//         return true\n//     }\n// }\nvar checkPermission=function checkPermission(){if(!checkCurrentPremiumPlan(courseDetails,userInfo)){console.log('tu co jest? :'+courseDetails.premiumPlan);console.log(checkCurrentPremiumPlan(courseDetails,userInfo));// navigateToHomePage()\n}};var likeCourse=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){var response,status;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return fetch(\"http://127.0.0.1:8000/api/courses/\".concat(userInfo.username,\"/\").concat(courseDetails.id),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({'course_id':courseDetails.id,'username':userInfo.username})});case 2:response=_context3.sent;_context3.next=5;return response.json();case 5:status=_context3.sent;console.log(status);setIsColorLiked(!isCourseLiked);case 8:case\"end\":return _context3.stop();}}},_callee3);}));return function likeCourse(){return _ref3.apply(this,arguments);};}();// effect function to check if there is an API call possible\nuseEffect(function(){courseDetailGET();tablesGET();// console.log(checkIfLiked())\n// checkPermission()\n},[courseDetails.premiumPlan]);var navigateToHomePage=function navigateToHomePage(){navigate('/');};return/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{className:\"fs-1\",children:[courseDetails.name,\" \",/*#__PURE__*/_jsx(LikeHeart,{handleOnClick:likeCourse,isLiked:isCourseLiked})]}),/*#__PURE__*/_jsx(\"p\",{className:\"fs-6\",children:courseDetails.body}),chessTables.map(function(table,index){return/*#__PURE__*/_jsx(ChessDiv,{text:table.text,coord:table.coord},index);})]})});};export default CoursePage;","map":{"version":3,"names":["React","useState","useEffect","useContext","UserContext","checkCurrentPremiumPlan","BsFillHeartFill","useParams","Link","useNavigate","ChessDiv","LikeHeart","CoursePage","userInfo","navigate","isCourseLiked","setIsColorLiked","courseSlug","slug","courseDetails","setCourseDetails","chessTables","setChessTables","courseDetailGET","fetch","response","json","data","console","log","navigateToHomePage","liked_by","indexOf","user_id","tablesGET","checkPermission","premiumPlan","likeCourse","username","id","method","headers","body","JSON","stringify","status","name","map","table","index","text","coord"],"sources":["C:/Users/tomas/Desktop/chess-masterclass/backend/chess_masterclass/frontend_chessmasterclass/src/pages/CoursePage.js"],"sourcesContent":["import React, { useState, useEffect, useContext } from 'react'\r\nimport {UserContext} from '../context/UserContext'\r\nimport {checkCurrentPremiumPlan} from '../utils/utlis'\r\nimport { BsFillHeartFill } from 'react-icons/bs'\r\n\r\nimport {\r\n    useParams,\r\n    Link,\r\n    useNavigate\r\n} from 'react-router-dom'\r\nimport ChessDiv from '../components/ChessDiv'\r\nimport LikeHeart from '../components/LikeHeart'\r\n\r\nconst CoursePage = () => {\r\n    let {userInfo} = useContext(UserContext)\r\n    let navigate = useNavigate()\r\n    const [isCourseLiked, setIsColorLiked] = useState(false)\r\n\r\n    // get dynamic ID (from App.js course/:id)\r\n    let courseSlug = useParams().slug\r\n\r\n    // list of course detail\r\n    let [courseDetails, setCourseDetails] = useState([])\r\n    let [chessTables, setChessTables] = useState([])\r\n\r\n    // fetch course details\r\n    let courseDetailGET = async () => {\r\n        let response = await fetch(`http://127.0.0.1:8000/api/courses/${courseSlug}`)\r\n        let data = await response.json()\r\n        setCourseDetails(data)\r\n        console.log(data)\r\n\r\n        if(!checkCurrentPremiumPlan(data, userInfo)){              \r\n            navigateToHomePage()\r\n        }\r\n\r\n        if(data.liked_by.indexOf(userInfo.user_id) === -1){        \r\n            setIsColorLiked(false)\r\n        }else{\r\n            setIsColorLiked(true)\r\n        }\r\n    }\r\n        \r\n    // function which call for api port with chess tables\r\n    let tablesGET = async () => {\r\n        let response = await fetch(`http://127.0.0.1:8000/api/courses/${courseSlug}/table`)\r\n        let data = await response.json()\r\n        setChessTables(data)\r\n        console.log(data)\r\n\r\n    }\r\n\r\n    // let checkIfLiked = () => {        \r\n    //     // if(courseDetails.liked_courses.indexOf(1) === -1){            \r\n    //     if(courseDetails.liked_by.indexOf(1) === -1){        \r\n    //         console.log(courseDetails.liked_by)\r\n    //         console.log(typeof(courseDetails.liked_by[0]))\r\n    //         console.log(typeof(1))\r\n    //         console.log(userInfo.user_id)\r\n    //         return false\r\n    //     }else{\r\n    //         return true\r\n    //     }\r\n    // }\r\n\r\n    let checkPermission = () => {\r\n        if(!checkCurrentPremiumPlan(courseDetails, userInfo)){  \r\n            console.log('tu co jest? :' + courseDetails.premiumPlan)          \r\n            console.log(checkCurrentPremiumPlan(courseDetails, userInfo))\r\n            // navigateToHomePage()\r\n        }\r\n    }\r\n\r\n    let likeCourse = async () => {\r\n        let response = await fetch(`http://127.0.0.1:8000/api/courses/${userInfo.username}/${courseDetails.id}`, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            },\r\n            body: JSON.stringify({\r\n                'course_id': courseDetails.id, 'username': userInfo.username\r\n            })\r\n        })\r\n        let status = await response.json()\r\n        console.log(status)\r\n        setIsColorLiked(!isCourseLiked)\r\n    }\r\n\r\n\r\n    \r\n\r\n    // effect function to check if there is an API call possible\r\n    useEffect(() => {\r\n        courseDetailGET()\r\n        tablesGET()\r\n        // console.log(checkIfLiked())\r\n        // checkPermission()\r\n    }, [courseDetails.premiumPlan, ])\r\n\r\n    \r\n    \r\n\r\n    let navigateToHomePage = () => {\r\n        navigate('/')\r\n    }  \r\n\r\n  return (\r\n    <div className='container'>\r\n            <div>\r\n                <p className=\"fs-1\">{courseDetails.name} <LikeHeart handleOnClick={likeCourse} isLiked={isCourseLiked}/></p>\r\n                <p className=\"fs-6\">{courseDetails.body}</p>   \r\n                {chessTables.map((table, index) => (\r\n                    <ChessDiv key={index} text={table.text} coord={table.coord} />\r\n                ))}\r\n\r\n                \r\n            </div>\r\n          \r\n\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default CoursePage"],"mappings":"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"},"metadata":{},"sourceType":"module"}